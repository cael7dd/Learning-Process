var Card=function(t){function e(e,i,s){t.call(this),this._x=i,this._y=s,this._num=e,this._container=new egret.DisplayObjectContainer,this.createCard()}__extends(e,t);var i=__define,s=e,a=s.prototype;return i(a,"container",function(){return this._container}),a.createCard=function(){this._text=new egret.TextField,this._text.text=this._num,this._cardA=new egret.DisplayObjectContainer,this._cardAB=new egret.Sprite,this._cardAB.graphics.beginFill(e.getRandomColor()),this._cardAB.graphics.drawRect(0,0,75,75),this._cardAB.graphics.endFill(),this._cardA.addChild(this._cardAB),this._cardA.addChild(this._text),this._text.x=25,this._text.y=25,this._cardB=new egret.Sprite,this._cardB.graphics.beginFill(e.getRandomColor()),this._cardB.graphics.drawRect(0,0,75,75),this._cardB.graphics.endFill(),this.addChild(this._cardB),this.addChild(this._cardA),this.x=this._x,this.y=this._y},a.wrongAnsAnimate=function(){var t=egret.Tween.get(this);t.to({x:this._x-10},100).to({x:this._x+10},200).to({x:this._x-10},200).to({x:this._x},100)},a.flipAnimate=function(t){t?this.scaleMin(this._cardA,this._cardB,this._text):this.scaleMin(this._cardB,this._cardA,null)},a.scaleMin=function(t,e,i){e.scaleX=0,e.x=37.5;var s=egret.Tween.get(t),a=this;s.to({scaleX:0,x:37.5},200),s.call(function(){a.scaleMax(e)},this,e)},a.scaleMax=function(t){var e=egret.Tween.get(t);e.to({scaleX:1,x:0},200)},e.getRandomColor=function(){var t;return t=Math.floor(16777215*Math.random()),t="0x"+t.toString(16)},e}(egret.DisplayObjectContainer);egret.registerClass(Card,"Card");var Main=function(t){function e(){t.call(this),this._stage=1,this.init()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.init=function(){this._result=new egret.TextField,this._result.x=220,this._showStage=new egret.TextField,this._showStage.x=200,this._showStage.y=700,this._lastStage=new egret.TextField,this._lastStage.text="上一关",this._lastStage.x=50,this._lastStage.y=750,this._nextStage=new egret.TextField,this._nextStage.text="下一关",this._nextStage.x=340,this._nextStage.y=750,this._lastStage.touchEnabled=!0,this._nextStage.touchEnabled=!0,this._cards=new egret.DisplayObjectContainer,this.addChild(this._cards),this.addLastAndNext(),this.addChild(this._showStage),this.addChild(this._nextStage),this.addChild(this._lastStage),this.addChild(this._result),this.stageStart()},s.stageStart=function(){console.log(this._stage),this._cards.removeChildren(),this._showStage.text="第"+this._stage+"关",this._result.text=0,this._cardAmount=2*this._stage,this._blockes=e.createBlocks(),this._shouldReverse=!0,this._rightNum=0,this._cardContainer=[],this.createCards(),this.addListener()},s.addLastAndNext=function(){var t=this;this._nextStage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){t._stage=Math.min(18,++t._stage),t.stageStart()},this),this._lastStage.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){t._stage=Math.max(1,--t._stage),t.stageStart()},this)},s.addListener=function(){for(var t=this,e=0;e<this._cardContainer.length;e++)this._cardContainer[e].touchEnabled=!0,this._cardContainer[e].addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){if(t._shouldReverse){for(var i=0;i<t._cardAmount;i++)t._cardContainer[i].flipAnimate(!0);t._shouldReverse=!1}else this._num-1==t._rightNum?(t._result.text=t._rightNum+1,t._rightNum++,this.flipAnimate(!1),t._rightNum==t._cardAmount&&(t._stage++,setTimeout(function(){t.stageStart()},1e3))):(t._result.text="wrong!",setTimeout(function(){t._result.text=t._rightNum+1},1e3),this.wrongAnsAnimate())},this._cardContainer[e])},s.createCards=function(){for(var t=0;t<this._cardAmount;t++){var e=Math.floor(Math.random()*this._blockes.length),i=this._blockes[e].x,s=this._blockes[e].y;this._blockes.splice(e,1);var a=new Card(t+1,75*i+5*(i+1),75*s+5*(s+1)+160);this._cardContainer.push(a),this._cards.addChild(a)}},e.createBlocks=function(){for(var t=[],e=0;6>e;e++)for(var i=0;6>i;i++)t.push({x:e,y:i});return t},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");